---
# Ansible Inventory for Certificate Revocation Lab
# All hosts are containers in the lab network (172.20.0.0/16)

all:
  hosts:
    localhost:
      ansible_connection: local
      ansible_python_interpreter: /usr/bin/python3
    # Lab host for running podman commands (accessible from EDA via SSH)
    lab-host:
      ansible_host: "{{ lookup('env', 'LAB_HOST_IP') | default('host.containers.internal', true) }}"
      ansible_connection: ssh
      ansible_user: "{{ lookup('env', 'LAB_HOST_USER') | default('czinda', true) }}"
      ansible_ssh_private_key_file: /app/.ssh/id_ed25519
      ansible_python_interpreter: /usr/bin/python3
      lab_root_dir: "{{ lookup('env', 'LAB_ROOT_DIR') | default('/home/czinda/git/cert-revocation-lab', true) }}"

  vars:
    ansible_python_interpreter: /usr/bin/python3
    lab_domain: cert-lab.local
    ipa_realm: CERT-LAB.LOCAL

  children:
    # PKI Infrastructure
    pki_servers:
      hosts:
        root-ca:
          ansible_host: 172.20.0.12
          pki_role: root
          pki_instance: pki-root-ca
        intermediate-ca:
          ansible_host: 172.20.0.11
          pki_role: intermediate
          pki_instance: pki-intermediate-ca
        iot-ca:
          ansible_host: 172.20.0.13
          pki_role: subordinate
          pki_instance: pki-iot-ca

    # Identity Management
    identity_servers:
      hosts:
        freeipa:
          ansible_host: 172.20.0.10
          ipa_server: true
          ipa_role: master

    # Directory Servers
    directory_servers:
      hosts:
        ds-root:
          ansible_host: 172.20.0.14
          ds_instance: root-ca
        ds-intermediate:
          ansible_host: 172.20.0.15
          ds_instance: intermediate-ca
        ds-iot:
          ansible_host: 172.20.0.16
          ds_instance: iot-ca

    # Automation Platform
    automation_servers:
      hosts:
        awx:
          ansible_host: 172.20.0.22
          awx_web_port: 8052
        awx-task:
          ansible_host: 172.20.0.23
        eda:
          ansible_host: 172.20.0.40
          eda_port: 5000

    # Event Infrastructure
    event_servers:
      hosts:
        kafka:
          ansible_host: 172.20.0.31
          kafka_port: 9092
        zookeeper:
          ansible_host: 172.20.0.30
          zookeeper_port: 2181

    # Security Tools
    security_tools:
      hosts:
        edr:
          ansible_host: 172.20.0.50
          api_port: 8000
        siem:
          ansible_host: 172.20.0.51
          api_port: 8000

    # Supporting Services
    support_services:
      hosts:
        postgres:
          ansible_host: 172.20.0.20
          db_port: 5432
        redis:
          ansible_host: 172.20.0.21
          redis_port: 6379
        jupyter:
          ansible_host: 172.20.0.60
          jupyter_port: 8888
