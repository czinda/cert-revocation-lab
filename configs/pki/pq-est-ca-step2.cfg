# Dogtag PKI Post-Quantum EST Sub-CA Configuration - Step 2: Certificate Installation
# This step completes the installation with the signed certificate from PQ Intermediate CA
# Uses ML-DSA-87 (NIST FIPS 204 Level 5) post-quantum signatures

[DEFAULT]
# Administrative credentials
pki_admin_email=admin@cert-lab.local
pki_admin_name=admin
pki_admin_password=RedHat123
pki_admin_uid=admin

# Security passwords
pki_backup_password=RedHat123
pki_client_database_password=RedHat123
pki_client_pkcs12_password=RedHat123
pki_token_password=RedHat123

# Directory Server connection
pki_ds_url=ldap://ds-pq-est.cert-lab.local:3389
pki_ds_bind_dn=cn=Directory Manager
pki_ds_password=RedHat123
pki_ds_database=pq-est-ca
pki_ds_base_dn=dc=pki,dc=pq-est-ca

# Security domain - join the PQ security domain
pki_security_domain_hostname=pq-root-ca.cert-lab.local
pki_security_domain_https_port=8443
pki_security_domain_name=CERT-LAB-PQ
pki_security_domain_user=admin
pki_security_domain_password=RedHat123

# Instance configuration
pki_instance_name=pki-pq-est-ca
pki_https_port=8443
pki_http_port=8080
pki_ajp_port=8009
pki_tomcat_server_port=8005

# Hostname
pki_hostname=pq-est-ca.cert-lab.local

[CA]
# External CA signing - Step 2 installs the signed certificate
pki_external=True
pki_external_step_two=True

# Certificate paths - the signed certificate and CA chain
pki_ca_signing_cert_path=/certs/est-ca-signed.crt
pki_cert_chain_path=/certs/ca-chain.crt

# CA Signing Certificate configuration (must match step 1) - ML-DSA-87
pki_ca_signing_subject_dn=CN=EST Sub-CA (ML-DSA-87),O=Cert-Lab,C=US
pki_ca_signing_key_algorithm=ML-DSA-87
pki_ca_signing_key_size=87
pki_ca_signing_key_type=mldsa
pki_ca_signing_signing_algorithm=ML-DSA-87

# OCSP Signing Certificate - ML-DSA-87
pki_ocsp_signing_subject_dn=CN=OCSP Signing Certificate,OU=PQ EST CA,O=Cert-Lab,C=US
pki_ocsp_signing_key_algorithm=ML-DSA-87
pki_ocsp_signing_key_size=87
pki_ocsp_signing_key_type=mldsa
pki_ocsp_signing_signing_algorithm=ML-DSA-87

# Audit Signing Certificate - ML-DSA-87
pki_audit_signing_subject_dn=CN=Audit Signing Certificate,OU=PQ EST CA,O=Cert-Lab,C=US
pki_audit_signing_key_algorithm=ML-DSA-87
pki_audit_signing_key_size=87
pki_audit_signing_key_type=mldsa
pki_audit_signing_signing_algorithm=ML-DSA-87

# Subsystem Certificate - ML-DSA-87
pki_subsystem_subject_dn=CN=Subsystem Certificate,OU=PQ EST CA,O=Cert-Lab,C=US
pki_subsystem_key_algorithm=ML-DSA-87
pki_subsystem_key_size=87
pki_subsystem_key_type=mldsa

# SSL Server Certificate - ML-DSA-87
pki_sslserver_subject_dn=CN=pq-est-ca.cert-lab.local,OU=PQ EST CA,O=Cert-Lab,C=US
pki_sslserver_key_algorithm=ML-DSA-87
pki_sslserver_key_size=87
pki_sslserver_key_type=mldsa

# Admin certificate
pki_admin_subject_dn=CN=PKI Administrator,OU=PQ EST CA,O=Cert-Lab,C=US
